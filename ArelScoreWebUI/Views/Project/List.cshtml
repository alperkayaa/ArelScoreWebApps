@model ArelScoreWebUI.Models.ViewModel.ProjectListViewModel

@{
    ViewData["Title"] = "Proje Listesi";
}

<!-- CDN: Bootstrap + Animate.css -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet" />
<style>
    body {
        background: linear-gradient(135deg, #f0f8ff, #e6f0ff);
        font-family: 'Segoe UI', sans-serif;
    }

    .hero {
        background: linear-gradient(135deg, #4f9dfc, #6b77f5);
        color: white;
        padding: 80px 0;
        text-align: center;
        border-radius: 0 0 50px 50px;
        box-shadow: 0 8px 24px rgba(0,0,0,0.1);
    }

        .hero h1 {
            font-size: 3rem;
            font-weight: 700;
        }

        .hero p {
            font-size: 1.25rem;
        }

    .project-card {
        transition: all 0.4s ease;
    }

        .project-card:hover {
            transform: scale(1.03);
            box-shadow: 0 10px 24px rgba(0, 0, 0, 0.15);
            border: 2px solid #007bff;
        }

    .card-title {
        color: #333;
    }

    .filter-bar {
        background: #ffffffcc;
        padding: 15px;
        border-radius: 12px;
        box-shadow: 0 2px 12px rgba(0,0,0,0.05);
    }
</style>

<!-- 🔍 FİLTRE BÖLÜMÜ -->
<div class="container my-5">
    <div class="row justify-content-between filter-bar mb-4">
        <div class="col-md-6 mb-2">
            <input type="text" id="searchInput" class="form-control" placeholder="🔍 Proje adına göre filtrele...">
        </div>
        <div class="col-md-5 mb-2">
            <select id="sortSelect" class="form-select">
                <option value="date">📅 Tarihe Göre (Yeni → Eski)</option>
                <option value="name">🔤 İsme Göre (A → Z)</option>
            </select>
        </div>
    </div>

    <!-- 📋 PROJE KARTLARI -->
    <div class="row" id="projectList">
        @if (Model != null && Model.Projects.Any())
        {
            foreach (var proje in Model.Projects)
            {
                <div class="col-md-6 col-lg-4 mb-4 project-card animate__animated animate__fadeIn"
                     data-name="@proje.Name"
                     data-date="@proje.UploadDate.Ticks">
                    <div class="card h-100 rounded-4 shadow-sm border-0">
                        <img src="@proje.ImageUrl" class="card-img-top rounded-top-4" alt="@proje.Name" style="object-fit: cover; height: 200px;">
                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title fw-bold">@proje.Name</h5>
                            <p class="card-text text-muted mb-3">
                                @(string.IsNullOrWhiteSpace(proje.Description)
                                    ? "Açıklama bulunmuyor."
                                    : proje.Description.Length > 100
                                        ? proje.Description.Substring(0, 100) + "..."
                                        : proje.Description)
                            </p>
                            <p class="mb-2">
                                ⭐ Ortalama Oy: <strong>@proje.Average.ToString("0.0")</strong> | 🗳️ Toplam Oy: <strong>@proje.TotalVotes</strong>
                            </p>
                            <div class="mt-auto">
                                <p class="small text-secondary mb-2">
                                    👤 @proje.OwnerName <br />
                                    📅 @proje.UploadDate.ToString("dd MMM yyyy HH:mm")
                                </p>
                                <a href="@Url.Action("Details", "Project", new { id = proje.Id })"
                                   class="btn btn-outline-primary btn-sm w-100 rounded-pill">Detayları Gör</a>
                            </div>
                        </div>
                    </div>
                </div>
            }
        }
        else
        {
            <div class="alert alert-warning text-center">
                Henüz proje eklenmemiş.
            </div>
        }
    </div>
</div>

<!-- 🔧 JS: Arama ve Sıralama -->
<script>
    const searchInput = document.getElementById('searchInput');
    const sortSelect = document.getElementById('sortSelect');

    searchInput.addEventListener('input', () => {
        const keyword = searchInput.value.toLowerCase();
        const cards = document.querySelectorAll('.project-card');
        cards.forEach(card => {
            const name = card.getAttribute('data-name').toLowerCase();
            card.style.display = name.includes(keyword) ? '' : 'none';
        });
    });

    sortSelect.addEventListener('change', () => {
        const container = document.getElementById('projectList');
        const cards = Array.from(document.querySelectorAll('.project-card'));
        const sorted = cards.sort((a, b) => {
            if (sortSelect.value === 'name') {
                return a.getAttribute('data-name').localeCompare(b.getAttribute('data-name'));
            } else {
                return b.getAttribute('data-date') - a.getAttribute('data-date');
            }
        });
        sorted.forEach(card => container.appendChild(card));
    });
</script>
